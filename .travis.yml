language: python

env:
  matrix:
    - python: "nightly"
    - python: 2.7
    - python: 3.6
    - python: 3.7
    - python: 3.8
    - python: 3.8
      env: EXTRAINSTALL="jinja2"

git:
  # hack around git fetch --unshallow failing and nuking the whole CI
  depth: 9999999

before_install:
  - export TRAVIS_PYTHON_VERSION=$python
  - . ~/scripts/install-miniconda.sh

install:
  - python setup.py install
  - pip install pytest pytest-cov $EXTRAINSTALL

script:
  - pytest --cov=doct --cov-report term-missing
